<html>

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<title>TeamWorkAPI</title>
	<script id="RTCEarlyScript" type="text/javascript">
		window.oldSetTimeout = window.setTimeout;
		window.setTimeout = function(func, delay) {
			return window.oldSetTimeout(function() {
				try {
					if (!document.documentElement.getAttribute('stopTimers')) {
						if (typeof func == 'string') {
							var nfunc = new Function(func);
							nfunc();
						} else func();
					}
				} catch (ex) {}
			}, delay);
		};
		window.oldSetInterval = window.setInterval;
		window.setInterval = function(func, delay) {
			return window.oldSetInterval(function() {
				try {
					if (!document.documentElement.getAttribute('stopTimers')) {
						if (typeof func == 'string') {
							var nfunc = new Function(func);
							nfunc();
						} else func();
					}
				} catch (ex) {}
			}, delay);
		};
	</script>
</head>

<body background="1.jpg">
	<p><b><br><h1>Назначение бригады СМП</h1></b>
		<form name="subscribe" id="SMP" action="#">
			<b>Выбор подстанции СМП</b><br>
			<select id="Podstantsiya" name="form1">
<option value = " Восточная ">Восточная подстанция</option>
<option value = " Центральная ">Центральная подстанция</option>
</select><br><br>
			<b>Выбор машины СМП</b><br>
			<select id="Mahina" name="Mahina">
	<optgroup label = "Центральной подстанции">
<option value = "у101уд"> у101уд </option>
<option value = "д202кф"> д202кф </option>
</optgroup>
	<optgroup label = "Восточная подстанция">
<option value = "а303уц"> а303уц </option>
<option value = "к404ек"> к404ек </option>
</optgroup>
</select><br><br>
			<b>Выбор бригады СМП</b><br>

			<body>
				<select id="Brigada" name="Brigada">
	<optgroup label = "Центральной подстанции">
<option value = "Вася Пупкин, Калашникова Светлана"> Вася Пупкин, Калашникова Светлана </option>
<option value = "Вашеця Максим, Кимовна Екатерина"> Вашеця Максим, Кимовна Екатерина </option>
</optgroup>
	<optgroup label = "Восточная подстанция">
<option value = "Пушкин Александр, Бунина Анна"> Пушкин Александр, Бунина Анна </option>
<option value = "Титов Александр. Кныш Оксана"> Титов Александр. Кныш Оксана </option>
</optgroup>
</select><br><br>
			</body>
			<b>Симптомы</b><br>
			<select id="Simptom" name="Simptom" multiple size="10">
	<optgroup label = "Общие">
<option value="Повышение температуры"> Повышение температуры </option>
<option value="Резкое повышение темпиратуры в сопутствии с появлением судорог/потери/нарушении сознания"> Резкое повышение темпиратуры в сопутствии с появлением судорог/потери/нарушении сознания </option>
<option value="Инородное тело в носу/глотке/ухе"> Инородное тело в носу/глотке/ухе </option>
<option value="Инородное тело глаза, инфицированная рана, конъюктивит"> Инородное тело глаза, инфицированная рана, конъюктивит </option>
<option value="Поражение элетротоком"> Поражение электротоком </option>
</optgroup>
	<optgroup label="Кровотечение">
<option value = "Кровотечение из носа/глотки/уха"> Кровотечение из носа/глотки/уха </option>
<option value="Обильное кровотечение"> Обильное кровотечение </option>
<option value="Кровотечение из половых путей, связанное с нарушением менструального цикла/ кровотечение у мужчин"> Кровотечение из половых путей, связанное с нарушением менструального цикла/ кровотечение у мужчин </option>
</optgroup>
	<optgroup label = "Сердце">
<option value = "Стенокардия впервые возникшая"> Стенокардия впервые возникшая </option>
<option value = "Стенокардия нестабильная/прогрессирующая"> Стенокардия нестабильная/прогрессирующая </option>
<option value="Некупирующийся приступ стенокардии (В течении 20 минут после приёма медикаметнов)"> Некупирующийся приступ стенокардии (В течении 20 минут после приёма медикаметнов) </option>
<option value="Боли в груди (При исключении случая травмы)"> Боли в груди (При исключении случая травмы) </option>
</optgroup>
	<optgroup label="Голова">
<option value="Анафилактический шок (После приема препарата, при постановке инъекции, нехватка воздуха, жар, резкое головокружение)"> Анафилактический шок (После приема препарата, при постановке инъекции, нехватка воздуха, жар, резкое головокружение) </option>
<option value="Нарушение сознания при сахарном диабете в анамнезе"> Нарушение сознания при сахарном диабете в анамнезе </option>
<option value="Головные боли"> Головные боли </option>
	</optgroup>
	<optgroup label="Живот">
<option value="Боли в области желудка"> Боли в области желудка </option>
<option value="Острые боли в области желудка"> Острые боли в области желудка </option>
<option value="Боли в области кишечника"> Боли в области кишечника </option>
<option value="Острые боли в области кишечника"> Острые боли в области кишечника </option>
<option value="Боль в животе возникшая  на фоне беременности/нарушения цикла"> Боль в животе возникшая  на фоне беременности/нарушения цикла </option>
<option value="Тошнота/рвота"> Тошнота/рвота </option>
<option value="Диарея"> Диарея </option>
<option value="Запор"> Запор </option>
	</optgroup>
	<optgroup label="Экзогенные отравления">
<option value="Прием лекарственных средств превышающих дозировку"> Прием лекарственных средств превышающих дозировку </option>
<option value="Прием алкоголя"> Прием алкоголя </option>
<option value="Прием наркотических средств"> Прием наркотических средств </option>
<option value="Прием отравляющих средств"> Прием отравляющих средств </option>
<option value="Отравление парами уграного газа/химических веществ"> Отравление парами уграного газа/химических веществ </option>
	</optgroup>
	<optgroup label="Ожоги">
<option value="Ожог лица"> Ожог лица</option>
<option value="Ожог конечности"> Ожог конечности </option>
<option value="Ожог промежности"> Ожог промежности </option>
<option value="Большая площядь ожога"> Большая площадь ожога </option>
<option value="Появление волдырей"> Появление волдырей </option>
<option value="Ожог вызванный химическими веществами"> Ожог вызванный химическими веществами </option>
	</optgroup>
	<optgroup label="Травмы">
<option value="Свежие травмы"> Свежие травмы </option>
<option value="Травмы головы сопровождающиеся потерей сознания, головокружением, тошнотой/рвотой"> Травмы головы сопровождающиеся потерей сознания, головокружением, тошнотой/рвотой</option>
<option value="Тупые травмы живота"> Тупые травмы живота </option>
<option value="Ушибы/ренения грудной клетки"> Ушибы/ренения грудной клетки </option>
<option value="Травмы конечностей"> Травмы конечностей </option>
	</optgroup>
	<optgroup label="Физиологические/Психологические">
<option value="ДТП"> ДТП </option>
<option value="Ножевые/огнестрельные/прочие ранения"> Ножевые/огнестрельные/прочие ранения </option>
<option value="Судороги"> Судороги </option>
<option value="Психическое нарушение"> Психическое нарушение</option>
<option value="Суицидальные состояния"> Суицидальные состояния </option>
<option value="Утопление"> Утопление </option>
<option value="Удавление"> Удавление </option>
	</optgroup>
</select><br><br><br>
	<b>Пол</b><br>
	<select id="Pol" name="Pol">
<option value="Мужской"> Мужской </option>
<option value="Женский"> Женский </option>
	</select><br><br>
<input type="text" name="form 6" id="vozrast" placeholder="дд.мм.гггг" /> - Возраст<br><br>
<input type="text" name="form2" id="adres" /> - Адрес<br><br>
<input type="time" name="form4" id="clok" /> - Время<br><br>
<input type="text" name="form5" id="nomer" /> - Контактный телефон<br><br>
<input type="button" name="submit" value="Отправить" onclick="posttask() + alert('Выполненно!');" />
		</form>
		<script>
			function base64encode(str) {
				var b64chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefg' +
					'hijklmnopqrstuvwxyz0123456789+/=';
				var b64encoded = '';
				var chr1, chr2, chr3;
				var enc1, enc2, enc3, enc4;

				for (var i = 0; i < str.length;) {
					chr1 = str.charCodeAt(i++);
					chr2 = str.charCodeAt(i++);
					chr3 = str.charCodeAt(i++);

					enc1 = chr1 >> 2;
					enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);

					enc3 = isNaN(chr2) ? 64 : (((chr2 & 15) << 2) | (chr3 >> 6));
					enc4 = isNaN(chr3) ? 64 : (chr3 & 63);

					b64encoded += b64chars.charAt(enc1) + b64chars.charAt(enc2) +
						b64chars.charAt(enc3) + b64chars.charAt(enc4);
				}
				return b64encoded;
			}

			function getXmlHttp() {
				var xmlhttp;
				try {
					xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");
				} catch (e) {
					try {
						xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
					} catch (E) {
						xmlhttp = false;
					}
				}
				if (!xmlhttp && typeof XMLHttpRequest != 'undefined') {
					xmlhttp = new XMLHttpRequest();
				}
				return xmlhttp;
			}

			function posttask() {
				var ipcod = 'shoe486ferry';
				var task_name =
					'.  Подстанция -  ' + document.getElementById('Podstantsiya').value +
					'. Машина -  ' + document.getElementById('Mahina').value +
					'. Бригада -  ' + document.getElementById('Brigada').value +
					'. Симптомы -  ' + document.getElementById('Simptom').value +
					'. Пол -  ' + document.getElementById('Pol').value +
					'. Возраст -  ' + document.getElementById('vozrast').value +
					'. Адрес -  ' + document.getElementById('adres').value +
					'. Дата и время -  ' + document.getElementById('clok').value +
					'. Контактный номер -  ' + document.getElementById('nomer').value + '. ';
				var start = "<request><todo-item>";
				var end = "</todo-item></request>";
				var content_el = "<content>" + task_name + "</content>";
				var xml_data = start + content_el + end;
				alert(base64encode(ipcod));
				var xmlhttp = getXmlHttp();
				var urlpm = 'https://ogbyzssmp.teamwork.com/tasklists/1335964/tasks.json';
				var auth = 'Basic ' + base64encode(ipcod);
				xmlhttp.open('POST', urlpm, false);
				xmlhttp.setRequestHeader('Authorization', auth);
				xmlhttp.setRequestHeader("Content-Type", "application/xml");
				xmlhttp.send(xml_data);
				if (xmlhttp.status == 200) {
					alert(xmlhttp.responseText);
				}
			}
		</script>
</body></html>
